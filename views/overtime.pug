extends template
block CONTENT
	div.panel.panel-primary(ng-app='overtime_app',ng-controller='overtime_ctrl')
		div.panel-heading Overtime
		div.panel-body
			form(ng-submit='addovertime()')
				select.form-control(ng-model='overtimeform.emp_id')
					option(ng-repeat='e in employees',ng-value='{{e.id}}') {{e.name}}
				input.form-control(type='number',step='0.25',placeholder='total waktu lembur dalam jam',ng-model='overtimeform.duration')
				input.form-control(type='date',ng-model='overtimeform.date')
				input.form-control(placeholder='keperluan lembur',ng-model='overtimeform.info')
				input.form-control.btn-primary(type='submit')
		table.table.table-stripped
			tr(ng-repeat='o in overtimes')
				td {{o.name}}
				td {{o.duration}}
				td {{o.date}}
				td {{o.info}}
	script.
		var app = angular.module('overtime_app',[])
		app.controller('overtime_ctrl',function($scope, $http) {
		    $scope.showovertime = function() {
		    	$scope.overtimes=[]
		        var response = $http.get('/overtime/show')
		        response.success(function(data, status, headers, config) {
		            $scope.overtimes=data
		        })
		        response.error(function(data, status, headers, config) {
		            alert("Error.")
		        })
		    }
		    $scope.overtimeform={}
			$scope.addovertime = function() {
		    	
		    	cfg={
			        	method:'POST',
			        	url:'/overtime/add',
			        	data:$scope.overtimeform
			        }
		    	$http.post('/overtime/add', $scope.overtimeform, cfg).then(function(x){$scope.showovertime()}, function(y){alert('error')});
		    }
		    $scope.getemployees = function() {
		    	$scope.employees=[]
		        var response = $http.get('/employees')
		        response.success(function(data, status, headers, config) {
		            $scope.employees=data
		        })
		        response.error(function(data, status, headers, config) {
		            alert("Error.")
		        })
		    }
		    $scope.getemployees()
		    $scope.showovertime()
		})
				